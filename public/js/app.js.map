{"version":3,"sources":["app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["$(function () {\n\n});\n\nif (typeof Object.assign != 'function') {\n  Object.assign = function(target, varArgs) { // .length of function is 2\n    'use strict';\n    if (target == null) { // TypeError if undefined or null\n      throw new TypeError('Cannot convert undefined or null to object');\n    }\n\n    var to = Object(target);\n\n    for (var index = 1; index < arguments.length; index++) {\n      var nextSource = arguments[index];\n\n      if (nextSource != null) { // Skip over if undefined or null\n        for (var nextKey in nextSource) {\n          // Avoid bugs when hasOwnProperty is shadowed\n          if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n            to[nextKey] = nextSource[nextKey];\n          }\n        }\n      }\n    }\n    return to;\n  };\n}\n\nvar colorMap = {\n  purple: {\n    full: '#a464c5',\n    tint: '#DBC1E8',\n    lightest: '',\n  },\n  red: {\n    full: '#f26046',\n    tint: '#FABFB5',\n    lightest: '#FDE9E6',\n  },\n  green: {\n    full: '#7abfb4',\n    tint: '#D7EBE8',\n    lightest: '',\n  },\n  blue: {\n    full: '#4e98da',\n    tint: '#B8D6F0',\n    lightest: '#E8F1FA',\n  },\n};\n\nvar categoryColors = {\n  \"AOA Communication\": colorMap.green,\n  \"Original Contribution\": colorMap.purple,\n  \"Reviews\": colorMap.purple,\n  \"Evidence-Based Clinical Reviews\": colorMap.purple,\n  \"Clinical Review\": colorMap.purple,\n  \"Clinical Practice\": colorMap.purple,\n  \"Brief Report\": colorMap.purple,\n  \"Medical Education\": colorMap.purple,\n  \"Case Report\": colorMap.purple,\n  \"Special Communication\": colorMap.purple,\n  \"Special Report\": colorMap.green,\n  \"Health Policy\": colorMap.green,\n  \"Still Relevant?\":  colorMap.green,\n  \"Editorials\": colorMap.green,\n  \"In My View\": colorMap.green,\n  \"Empathy in Medicine\": colorMap.red,\n  \"The Somatic Connection\": colorMap.red,\n  \"Clinical Images\": colorMap.red,\n  \"In Your Words\": colorMap.red,\n  \"Letters to the Editor\": colorMap.green,\n  \"SURF\": colorMap.red,\n  \"CME Quiz\": colorMap.blue,\n  \"Book Reviews\": colorMap.red,\n};\n\n$(document).ready(function() {\n\n    var owner = window.location.pathname.substr(1);\n\n    var vueData = {};\n\n    var newVue = function(vueData) {\n\n        new Vue({\n            el: '#workspace',\n            data: vueData,\n            methods: {\n                copyHtml: function() {\n                  this.collapseSelection('clone');\n                  this.cloneRenderedVersion();\n\n                  var clipboard = new Clipboard('#copyHtml', {\n                    target: function(trigger) {\n                      return document.getElementById('clone');\n                    }\n                  });\n\n                  clipboard.on('success', function(evt) {\n                    console.log('Copied!');\n                    $('#highlight').effect('highlight', { color: 'lightyellow' }, 'slow');\n                    clipboard.destroy();\n                  });\n                },\n\n                copyTextVersion: function(trigger) {\n                    var clipboard = new Clipboard('#copyTextVersion', {\n                        text: this.textVersion\n                    });\n\n                    clipboard.on('success', function(e) {\n                        $('#highlight').effect('highlight', { color: 'azure' }, 'slow');\n                        clipboard.destroy();\n                    });\n\n\n                    clipboard.on('error', function(e) {\n                        clipboard.destroy();\n                    });\n                },\n\n                textVersion: function(trigger) {\n                    var component = trigger.dataset.component;\n                    switch (component) {\n                        case 'article':\n                            return [\n                                vueData.kicker,\n                                vueData.headline.toUpperCase(),\n                                '------------------------------------' +\n                                    '------------------------------------',\n                                vueData.excerpt,\n                                vueData.link,\n                                '',\n                            ].join('\\n');\n                            \n                            break;\n                        case 'date':\n                            return [\n                                'Most recent posts: ' + vueData.date,\n                                '(http://thedo.osteopathic.org)',\n                                '',\n                            ].join('\\n');\n                            \n                            break;\n                        \n                        case 'section-title':\n                            return [\n                                vueData.section_title\n                                    .toUpperCase()\n                                    .split('')\n                                    .join(' '),\n                                '',\n                            ].join('\\n');\n                            \n                            break;\n                        \n                        case 'quote':\n                            return [\n                                '\\n',\n                                'Q U O T E D',\n                                '\\n',\n                                vueData.quote,\n                                '--' + vueData.quoter,\n                                vueData.link,\n                            ].join('\\n');\n                            \n                            break;\n  \n                        case 'jaoa-article':\n                          return [\n                            vueData.cateogry,\n                            vueData.title.toUpperCase(),\n                            vueData.authors,\n                            '------------------------------------' +\n                                '------------------------------------',\n                            vueData.blurb,\n                            vueData.articleUrl,\n                            '',\n                          ].join('\\n');\n                    }\n                },\n\n                log: function(evt) {\n                  console.log(evt);\n                },\n\n                handleCategoryChange: function(evt) {\n                  var category = evt.targetVM.category;\n                  setArticleColors(category);\n                },\n\n                onClick: function() {\n                    console.log('onclick');\n                },\n\n                collapseSelection: function(elementId) {\n                    var elem = document.getElementById(elementId);\n                    if (window.getSelection()) {\n                        window.getSelection().collapse(elem, 0);\n                    }\n                },\n\n                cloneRenderedVersion: function() {\n                    var htmlVersion = document.getElementById('highlight');\n                    $('#clone').text(htmlVersion.innerHTML);\n                }\n            },\n            ready: function() {\n                console.log('ready');\n            },\n            attached: function() {\n                console.log('attached');\n            }\n        });\n    };\n\n    function getForm(form, selected) {\n        return $.ajax('form', {\n            data: form, \n            async: false,\n            success: function(data) {\n                $('#form').html(data);\n                console.log('got form');\n            }\n        });\n    };\n\n    function getRendered(selected) {\n        return $.ajax('render/' + owner + '/' + selected, {\n            async: false,\n            success: function(data) {\n                $('#highlight').html(data);\n                console.log('got rendered');\n            }\n        });\n    };\n\n    function clearInputs() {\n      // leave \"More stories\" in the input\n      if ($('input').val() != 'More stories') {\n          $('input, textarea').val('');\n      }\n    }\n\n    /**\n     * http://stackoverflow.com/questions/1740700/\n     *   how-to-get-hex-color-value-rather-than-rgb-value\n     *\n     */\n    function rgb2Hex(rgb) {\n\n      if (rgb.search('rgb') == -1) {\n        return rgb;\n      }\n\n      rgb = rgb.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+))?\\)$/);\n\n      function hex(x) {\n        return (\"0\" + parseInt(x).toString(16)).slice(-2);\n      }\n\n      return \"#\" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);\n      \n    }\n\n    function setArticleColors(category) {\n\n      var color = categoryColors[category];\n\n      $table = $('#categoryTable');\n    \n      $table\n        .attr('bgcolor', color.full)\n        .find('tr > td')\n          .css('background-color', color.full);\n\n      $table.find('table td').eq(1)\n        .attr('style', \n              'border-top: 4px solid ' + color.tint + \n                '; font-size: 0;');\n      \n      $('#articleTitle')\n        .attr('style', \"text-decoration: none; font-family: 'Raleway', Helvetica, arial, sans-serif; font-weight: 500; font-size: 22px; line-height: 28px; color: \" + color.full + ';');\n    }\n\n    function setVueData(selected) {\n        vueData = {};\n\n        switch (selected) {\n            case 'top-story':\n                vueData = {\n                    kicker: 'lorem kicker',\n                    headline: 'Lorem headline',\n                    excerpt: 'Lorem excerpt',\n                    link: '',\n                    imageUrl: 'http://placehold.it/480x320',\n                };\n                break;\n             case 'feature':\n                vueData = {\n                    kicker: 'lorem kicker',\n                    headline: 'Lorem headline',\n                    excerpt: 'Lorem excerpt',\n                    link: '',\n                    imageUrl: 'http://placehold.it/320x213',\n                    ruleBelow: true,\n                    ruleAbove: false,\n                };\n                break;\n             case 'brief':\n                vueData = {\n                    kicker: 'lorem kicker',\n                    headline: 'Lorem headline',\n                    excerpt: 'Lorem excerpt',\n                    link: '',\n                    imageUrl: 'http://placehold.it/134x89',\n                    ruleBelow: true,\n                    ruleAbove: false,\n                };\n                break;\n             case 'quote' :\n                vueData = {\n                    quote: 'Lorem quote',\n                    quoter: 'Lorem quoter',\n                    link: '',\n                };\n                break;\n             case 'date' :\n                vueData = {\n                    date: 'Lorem',\n                };\n                break;\n             case 'section-title' :\n                vueData = {\n                    section_title: 'More stories',\n                };\n                break;\n             case 'jaoa-article' :\n                vueData = {\n                  title: 'Lorem article title',\n                  category: 'Original Contribution',\n                  authors: 'Lorem authors',\n                  blurb: '',\n                  articleUrl: '',\n                  imageUrl: '',\n                  free: false,\n                  video: false,\n                };\n                break;\n             case 'jaoa-banner' :\n                vueData = {\n                  alt: 'Banner image',\n                  imageUrl: 'http://placehold.it/600x300',\n                };\n                break;\n        }\n\n        return vueData;\n    };\n\n    function isJaoaArticle(term) {\n      return term.indexOf('jaoa-article') === 0;\n    }\n\n    function render() {\n        var selected = $('select#articleType').val();\n        var form = $('form#selectArticleType').serialize();\n\n        // clear the cloned section\n        $('#workspace').fadeToggle(300, function() {\n            $('#clone').text('');\n            $('#highlight').html('');\n            $('#form').html('');\n\n            vueData = setVueData(selected);\n    \n            var request = getForm(form, selected),\n                chained = getRendered(selected);\n\n            chained.done(function() {\n                newVue(vueData);\n                clearInputs();\n\n                if (isJaoaArticle(selected)) {\n                  setArticleColors(vueData.category);\n                }\n                \n                $('#workspace').delay(300).fadeToggle(300);\n            });\n        });\n    };\n\n\n    $('select#articleType').change(render);\n\n    $('#workspace').on('click', '#refresh', render);\n\n    // kick things off\n    render();\n\n});\n"]}